///
/// @package @maddimathon/design-system-utilities@0.1.1-alpha.0.draft
/// @since 0.1.0-alpha
///

@use 'pkg:@maddimathon/utility-sass/list';
@use 'pkg:@maddimathon/utility-sass/map';

@use '../../config';
@use '../../tokens';

// @use 'pkg:@maddimathon/utility-astro/01-functions' as utils;

///
/// Uses the transition time tokens to prepare the appropriate numerical value
/// (in unitless rem).
///
/// @since 0.1.0-alpha
///
@function transition-time-value($level) {
    $value: map.get(tokens.$transition, time, #{$level});

    @if $value == null {
        @warn "$level '#{$level}' was not a key in tokens.$transition['time']";
        $value: map.get(tokens.$transition, time, normal);
    }

    @return $value;
}

///
/// Uses the transition time tokens to print the appropriate var(...) with
/// a fallback.
///
/// @since 0.1.0-alpha
///
@function var-tr-time($level) {
    @return if(
        config.$fn_var_replaceWithValue_transitionTime,
        #{transition-time-value($level)},
        var(
            --#{config.$cxPropPre}tr-time-#{$level},
            #{transition-time-value($level)}
        )
    );
}

$_transition: ();
@each $prop in map.get(tokens.$designSystem, transition, properties, always) {
    $_transition: list.append(
        $_transition,
        '#{$prop} #{var-tr-time(fast)} ease-in-out',
        $separator: comma
    );
}

$_motionTransition: ();
@each $prop in map.get(tokens.$designSystem, transition, properties, motion) {
    $_motionTransition: list.append(
        $_motionTransition,
        '#{$prop} #{var-tr-time(fast)} ease-in-out',
        $separator: comma
    );
}

///
/// Uses the transition properties tokens to prepare a list of transition shorthand values.
///
/// @since 0.1.0-alpha
///
@function transition-properties-value(
    $withMotion: false,
    $time: var-tr-time(fast)
) {
    // returns
    @if $time == var-tr-time(fast) {
        @return if($withMotion, $_motionTransition, $_transition);
    }

    $transition: ();
    @each $prop
        in map.get(
            tokens.$designSystem,
            transition,
            properties,
            if($withMotion, motion, always)
        )
    {
        $transition: list.append(
            $transition,
            '#{$prop} #{$time} ease-in-out',
            $separator: comma
        );
    }

    @return $transition;
}
