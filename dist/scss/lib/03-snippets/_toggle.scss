///
/// @package @maddimathon/design-system-utilities@0.1.0-alpha.draft
/// @since 0.1.0-alpha.draft
///

// @use 'pkg:@maddimathon/utility-sass/colour';
@use 'pkg:@maddimathon/utility-sass/list';
// @use 'pkg:@maddimathon/utility-sass/map';
// @use 'pkg:@maddimathon/utility-sass/math';
// @use 'pkg:@maddimathon/utility-sass/meta';
@use 'pkg:@maddimathon/utility-sass/selector';
// @use 'pkg:@maddimathon/utility-sass/string';

@use '../01-functions' as *;
@use '../02-mixins' as *;

@use 'utils';

$_defaultHeadingSelectors: list.join(selector-all-headings(), ('%title'));

$_defaultHeadingSelectors_bigOnly: ('%title');

$_defaultHeadingSelectors_greaterThan6: ();

@each $level in token-all-heading-levels() {
    @if $level < 7 {
        $_defaultHeadingSelectors_bigOnly: list.append(
            $_defaultHeadingSelectors_bigOnly,
            ('%h#{$level}')
        );
    }
    @if $level > 6 {
        $_defaultHeadingSelectors_greaterThan6: list.append(
            $_defaultHeadingSelectors_greaterThan6,
            ('%h#{$level}')
        );
    }
}

///
/// Supports the Toggle astro component.
///
@mixin snippet-support-toggle(
    $headingSelectors: $_defaultHeadingSelectors,
    $headingSelectors_bigOnly: $_defaultHeadingSelectors_bigOnly
) {
    $_has_directHeadingSelectors: ();

    @each $_hdg in $headingSelectors {
        $_has_directHeadingSelectors: list.append(
            $_has_directHeadingSelectors,
            "&:has( #{selector.nest('>', ($_hdg))} )",
            $separator: comma
        );
    }

    @include utils.snippet-support-toggle(
        $headingSelectors: $headingSelectors,
        $headingSelectors_bigOnly: $headingSelectors_bigOnly
    );

    [data-toggle-container] {
    }

    @include js {
        [data-toggle-container] {
            > [data-toggle-content] {
                border-width: #{var-border-width('300')};
                border-block-start-width: #{var-border-width('200')};
                border-color: #{var-theme(ui-grey)};
            }
        }
    }

    .toggle-title {
        &,
        [data-toggle-container='open'] & {
            @include hover-focus-visible {
                color: #{var-theme(link)};

                #{selector.nest('>', ($headingSelectors))} {
                    color: inherit;
                }

                + [data-toggle-content] {
                    border-color: #{var-theme(link)};
                }
            }
        }

        // [data-toggle-container] & {
        //     #{$_has_directHeadingSelectors} {
        //         @include hover-focus-visible {
        //             color: #{var-theme(link-hover)};

        //             + [data-toggle-content] {
        //                 border-color: #{var-theme(link-hover)};
        //             }
        //         }
        //     }
        // }

        [data-toggle-container='open'] & {
            @include js {
                color: #{var-theme(link-hover)};

                #{selector.nest('>', ($headingSelectors))} {
                    color: inherit;
                }

                + [data-toggle-content] {
                    border-color: #{var-theme(ui-grey)};
                    border-block-start-color: #{var-theme(link-hover)};
                }
            }
        }
    }

    [data-toggle-control] {
        [data-toggle-container='open'] & {
            @include js {
                color: currentColor;
            }
        }

        &,
        [data-toggle-container='open'] & {
            @include hover-focus-visible {
                color: currentColor;
            }
        }
    }

    .toggle-icon {
        > svg {
        }
    }

    .toggle-control-inner {
    }
}
