///
/// @package @maddimathon/design-system-utilities@0.1.0-alpha.11
/// @since 0.1.0-alpha
///

@use 'pkg:@maddimathon/utility-sass/feature-check';

// @use 'pkg:@maddimathon/utility-astro/03-snippets' as lib;

@use '../../config';
// @use '../../tokens';

@use '../01-functions' as *;
@use '../02-mixins' as *;

///
/// Makes a utility-astro ToggleNav component sticky, assuming it has
/// .nav-primary and is a direct child of the body element.
///
/// @since 0.1.0-alpha
///
@mixin snippet-support-astro-sticky-toggle-nav {
    @if not config.$print_astro_toggleNav {
        @include snippet-support-astro-toggle-nav-menu;
    }

    @include feature-check.supports(whereSelector) {
        $_navHeight: 3.125rem;
        $_scrollPaddingFallback: calc(
            #{$_navHeight} + #{var-gap-block(layout)}
        );

        &,
        & body {
            @include cx-prop(height-nav-primary, $_navHeight);

            @include cx-prop(scroll-padding-top, $_scrollPaddingFallback);
            @include cx-prop(
                scroll-padding-top,
                calc(
                    var(
                            --#{config.$cxPropPre}height-nav-primary,
                            #{$_navHeight}
                        ) +
                        var-gap-block(layout)
                )
            );

            scroll-padding-top: var(
                --#{config.$cxPropPre}scroll-padding-top,
                #{$_scrollPaddingFallback}
            );
        }

        body {
        }

        .nav-primary[data-toggle-container] {
            position: sticky;
            top: 0;
            grid-row: 1;

            margin: 0;
            padding: 0;
            gap: 0;

            z-index: 9999;

            > .toggle-title {
                min-height: var(
                    --#{config.$cxPropPre}height-nav-primary,
                    #{$_navHeight}
                );

                [data-toggle-control] {
                    padding-block: min(0.75vh, #{var-mrg-soft('300')});
                }
            }

            &[data-toggle-container='open'] {
                [data-toggle-control-backdrop] {
                    opacity: 0;
                    animation: fade-in #{var-tr-time(normal)} ease-in-out 10ms
                        forwards;
                }
            }

            &[data-toggle-container='closing'] {
                [data-toggle-control-backdrop] {
                    opacity: 0;
                    animation: fade-out #{var-tr-time(normal)} ease-in-out 0ms
                        forwards;
                }
            }
        }

        .website-settings-menu {
            margin-block-start: 0;
        }
    }
}
