///
/// @package @maddimathon/design-system-utilities@0.1.1-alpha.1.draft
/// @since 0.1.0-alpha.3
///

@use 'pkg:@maddimathon/utility-sass/list';
@use 'pkg:@maddimathon/utility-sass/map';
@use 'pkg:@maddimathon/utility-sass/selector';
@use 'pkg:@maddimathon/utility-sass/string';

// @use 'pkg:@maddimathon/utility-astro/03-snippets' as lib;

// @use '../../../config';
@use '../../../tokens';

@use '../../01-functions' as *;
@use '../../02-mixins' as *;

$_allUniqueLogoAspectRatios: ();

@each $slug, $map in tokens.$logos {
    $_ratio: map.get($map, aspectRatio);

    $_ratioSlug: string.slugify(#{$_ratio});

    @if not map.has-key($_allUniqueLogoAspectRatios, $_ratioSlug) {
        //
        $_ratioList: aspect-ratio-string-to-list($_ratio);

        $_allUniqueLogoAspectRatios: map.set(
            $_allUniqueLogoAspectRatios,
            $_ratioSlug,
            (
                ratio: $_ratio,
                width: list.nth($_ratioList, 1),
                height: list.nth($_ratioList, 2),
            )
        );
    }
}

///
/// Adds support for logos, assuming the html matches that in the local astro
/// Icon component.
///
/// @since 0.1.0-alpha.3
///
@mixin snippet-support-logos {
    %brand-logo {
        display: block;
        position: relative;
        margin-block: #{var-mrg-firm('400')} #{var-mrg-half('400')};

        color: #{var-theme(text-primary)};

        > svg {
            fill: currentColor;
        }
    }

    @each $slug, $map in $_allUniqueLogoAspectRatios {
        %brand-logo-aspect-ratio--#{$slug} {
            @include aspect-ratio(map.get($map, width), map.get($map, height));
        }
    }

    @each $slug, $map in tokens.$logos {
        %brand-logo {
            &--#{$slug} {
                $aspectRatio: logo-aspect-ratio-value($slug);
                @extend %brand-logo-aspect-ratio--#{string.slugify( #{$aspectRatio} )};
            }
        }
    }
}
