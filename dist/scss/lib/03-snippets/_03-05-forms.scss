///
/// @package @maddimathon/design-system-utilities@0.1.0-alpha.draft
/// @since 0.1.0-alpha.draft
///

@use 'pkg:@maddimathon/utility-sass/meta';

@use '../../config';
@use '../../tokens';

@use '../01-functions' as *;
@use '../02-mixins' as *;

@use '03-00-tokens' as *;
@use '03-03-typography' as *;

@use 'pkg:@maddimathon/utility-astro/03-snippets' as utils;

///
/// Colour properties for an input element.
///
/// @since 0.1.0-alpha.draft
///
@mixin snippet-button-colours($variation: 'primary') {
    --focus-ring-outline-color: #{var-theme(button-#{$variation}-border)};
    --icon-color: #{var-theme(button-#{$variation}-ui)};
    --theme-link-icon: #{var-theme(button-#{$variation}-ui)};
    accent-color: #{var-theme(button-#{$variation}-border)};
    background-color: #{var-theme(button-#{$variation}-bg)};
    border-color: #{var-theme(button-#{$variation}-border)};
    color: #{var-theme(button-#{$variation}-text)};

    @include hover-focus-visible-or-within {
        --focus-ring-outline-color: #{var-theme(
                button-#{$variation}-border-hover
            )};
        --icon-color: #{var-theme(button-#{$variation}-ui-hover)};
        --theme-link-icon: #{var-theme(button-#{$variation}-ui-hover)};
        accent-color: #{var-theme(button-#{$variation}-border-hover)};
        background-color: #{var-theme(button-#{$variation}-bg-hover)};
        border-color: #{var-theme(button-#{$variation}-border-hover)};
        color: #{var-theme(button-#{$variation}-text-hover)};
    }

    &:active {
        --focus-ring-outline-color: #{var-theme(
                button-#{$variation}-border-active
            )};
        --icon-color: #{var-theme(button-#{$variation}-ui-active)};
        --theme-link-icon: #{var-theme(button-#{$variation}-ui-active)};
        accent-color: #{var-theme(button-#{$variation}-border-active)};
        background-color: #{var-theme(button-#{$variation}-bg-active)};
        border-color: #{var-theme(button-#{$variation}-border-active)};
        color: #{var-theme(button-#{$variation}-text-active)};
    }
}

///
/// Base styles for a button element.
///
/// @since 0.1.0-alpha.draft
///
@mixin snippet-button(
    $includeDisabled: true,
    $includeUtils: true,
    $variation: 'primary',
    $args...
) {
    $args: meta.keywords($args);

    $focusOffset: var-border-width('300');

    @if $includeUtils {
        @include utils.snippet-button(
            $focusOffset: $focusOffset,
            $opacity_hover: 1,
            $includeClrs: false,
            $args...
        );
    } @else {
        --focus-ring-outline-offset: #{$focusOffset};

        @include colour-mode-interactive-mixin(
            $modes: (
                low,
                average,
            ),
            $hover: true,
            $focus: true,
            $focusWithin: true,
            $includeDefault: false
        ) {
            opacity: 1;
        }
    }

    & {
        --icon-pseudo-element-margin-block-start: 0.09375em;
        transition: var(--transition);
        @include snippet-button-colours($variation);

        @if $includeDisabled {
            &[aria-disabled='true'] {
                @include snippet-button-colours(disabled);

                &::before {
                    @if config.$template_button_inlineIcons {
                        @include snippet-icon-pseudo-element(
                            forbidden,
                            $pseudo: before
                        );
                    }
                }
            }
        }

        * {
            --icon-color: inherit !important;
            color: inherit !important;
        }

        ::selection {
            @each $mode in tokens.$contrastMode_all {
                @include colour-mode($mode, $includeDefault: false) {
                    @include snippet-selection($mode);
                }
            }
        }
    }
}

///
/// Base styles for an input element.
///
/// @since 0.1.0-alpha.draft
///
@mixin snippet-input($includeUtils: true, $args...) {
    $args: meta.keywords($args);

    $borderWidth: var-border-width('200');

    $accentClr: var-theme(field-accent);
    $accentClr_active: var-theme(field-accent-active);
    $accentClr_hover: var-theme(field-accent-hover);

    $background: var-theme(field-bg);
    $background_active: var-theme(field-bg-active);
    $background_hover: var-theme(field-bg-hover);

    $borderClr: var-theme(field-border);
    $borderClr_active: var-theme(field-border-active);
    $borderClr_hover: var-theme(field-border-hover);

    $color: var-theme(field-text);
    $color_active: var-theme(field-text-active);
    $color_hover: var-theme(field-text-hover);

    $focusOffset: var-border-width('300');

    @if $includeUtils {
        @include utils.snippet-input(
            $accentClr: $accentClr,
            $accentClr_active: $accentClr_active,
            $accentClr_hover: $accentClr_hover,

            $background: $background,
            $background_active: $background_active,
            $background_hover: $background_hover,

            $borderClr: $borderClr,
            $borderClr_active: $borderClr_active,
            $borderClr_hover: $borderClr_hover,

            $color: $color,
            $color_active: $color_active,
            $color_hover: $color_hover,

            $borderWidth: $borderWidth,
            $focusOffset: $focusOffset,
            $opacity_hover: 1,

            $includeClrs: true,
            $includePlaceholder: false,
            $args...
        );
    } @else {
        --focus-ring-outline-color: #{$accentClr};
        --focus-ring-outline-offset: #{$focusOffset};
        background-color: #{$background};
        color: #{$color};
        accent-color: #{$accentClr};
        border-width: #{$borderWidth};

        @include hover-focus-visible-or-within {
            --focus-ring-outline-color: #{$accentClr_hover};
            background-color: #{$background_hover};
            border-color: #{$borderClr_hover};
            color: #{$color_hover};
            accent-color: #{$accentClr_hover};
        }

        &:active {
            --focus-ring-outline-color: #{$accentClr_active};
            background-color: #{$background_active};
            border-color: #{$borderClr_active};
            color: #{$color_active};
            accent-color: #{$accentClr_active};
        }
    }

    & {
        transition: var(--transition);
    }
}

///
/// Base styles for the types of an element. Uses the & as input.
///
/// @since 0.1.0-alpha.draft
///
@mixin snippet-input-types(
    $includeUtils: true,
    //
    $accentClr: var-theme(field-border),
    $accentClr_active: var-theme(field-border-active),
    $accentClr_hover: var-theme(field-border-hover),
    $includeBase: true,
    $args...
) {
    $args: meta.keywords($args);

    @include utils.snippet-input-types(
        $accentClr: $accentClr,
        $accentClr_active: $accentClr_active,
        $accentClr_hover: $accentClr_hover,
        $includeBase: $includeBase,

        $includeClrs: true,
        $args...
    );

    &[type='submit'][disabled],
    &[type='reset'][disabled] {
        @include snippet-button-colours(disabled);
    }
}

///
/// Base styles for a form label, including check and radio boxes.
///
/// @since 0.1.0-alpha.draft
///
@mixin snippet-label(
    $color: var-theme(text-primary),
    $color_checkradio: var-theme(text),
    //
    // $gap: var-mrg-soft('300'),
    // $lh_checkradio: var-line-height('400'),
    // $lh: var-line-height('200'),
    // $marginBlock_innercheckradio: var-mrg-firm('200'),
    // $marginBlock: var-mrg-firm('400')
    $args...
) {
    $args: meta.keywords($args);

    @if $includeUtils {
        @include utils.snippet-label(
            $color: $color,
            $color_checkradio: $color_checkradio,
            $includeClrs: true,
            $args...
        );
    }
}
