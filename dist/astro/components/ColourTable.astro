---
/**
 * @since 0.1.0-alpha.draft
 *
 * @packageDocumentation
 */

/* import - types */
import type { TokenLevels_Extended } from '../../ts/02-new-tokens/@types.d.ts';
import type { Tokens_Internal } from '../../ts/02-new-tokens/Tokens.js';
import type { Tokens_Colour } from '../../ts/02-new-tokens/Tokens_Colour.js';

/* import - functions */
import { colourToArray } from '../functions/colourToArray.js';
import ColourTable_Scripts from '../support/ColourTable_Scripts.astro';

/* import - values */

/* import - components */
import Table from '@maddimathon/utility-astro/components/Table';
import ColourShadeSwatch from './ColourShadeSwatch.astro';
// import VariableDump from '@maddimathon/utility-astro/components/VariableDump';

/* import - layouts */

/* TYPES ===================================== */

/* PROPS ===================================== */

export interface Props<
    T_ColourName extends string = Tokens_Internal.Default_ColourName,
    T_ExtraLevels extends TokenLevels_Extended = Tokens_Internal.Default_ExtraColourLevels,
> {

    /** Unique. */
    id: string;
    
    colour: Tokens_Colour.JsonReturn<T_ColourName, T_ExtraLevels>;

    frontmatter?: Omit<Props<T_ColourName, T_ExtraLevels>, 'frontmatter'>;
}

const {
    id,
    ...props
}: Props = Astro.props.frontmatter ?? Astro.props;

/* FUNCTIONS ===================================== */

/* CONSTANTS ===================================== */

const colour = colourToArray(props);
---

{
    colour && (
        <label class='site-width colour-table-wrapper__text-control-label' aria-ignore="true"><input type="checkbox" data-colour-table-on-and-off={id} /> Display table without text</label>
        <Table id={id} wrapper={{ class: 'site-width colour-table-wrapper' }}>
            {colour.map(({ name, map }) => (
                <tr>
                    {map.map(({ level, values }) => (
                        <td>
                            <ColourShadeSwatch 
                                name={name} 
                                level={level}
                                values={{
                                    ...values,
                                    hsl: undefined,
                                    lch: undefined,
                                    rgb: undefined,
                                }}
                                bases={props.colour.base}
                            />
                        </td> 
                    ))}
                </tr>
            ))}
        </Table>
    )
}

<ColourTable_Scripts />

<style lang="scss" is:global>
    @forward '../css/colour-table';
</style> 