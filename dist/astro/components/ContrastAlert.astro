---
/**
 * @since 0.1.0-alpha
 *
 * @packageDocumentation
 */

/* import - types */
import type { ComponentProps } from 'astro/types';

/* import - functions */
import { getColourValue } from '../functions/getColourValue.js';

/* import - values */

/* import - components */
import AstroIcon from '@maddimathon/utility-astro/components/Icon';
import { ColourUtilities } from '../../ts/01-utilities/ColourUtilities.js';

/* import - layouts */

/* PROPS ===================================== */

export interface Props {
    clr: null | ColourUtilities.SingleShade;
    clrSlug: string;
    level: string;
    type: NonNullable<ComponentProps<typeof AstroIcon>['type']>;

    brightness?: string;
    class?: string | string[];
    title?: string;
}

const {
    brightness,
    class: classList,
    clr,
    clrSlug,
    level,
    title,
    type,
}: Props = Astro.props;

/* CONSTANTS ===================================== */

const varClr = clr && getColourValue(clr);
---

<div
    class:list={['contrast-alert', classList]}
    data-brightness-mode='light'
    style={varClr ? `--contrast-alert-color: ${varClr};` : undefined}
    title={title ?? clrSlug}
>
    <AstroIcon type={type} />
    <span
        data-brightness-mode={(brightness ?? Number(level) <= 500)
            ? 'dark'
            : 'light'}
        set:text={level}
        style='background: transparent'
    />
    <slot />
</div>

<style lang='scss' is:global>
    @forward '../scss/contrast-alert';
</style>
