///
/// @package @maddimathon/design-system-utilities@___CURRENT_VERSION___
/// @since ___PKG_VERSION___
///

@use 'pkg:@maddimathon/utility-sass/colour';
// @use 'pkg:@maddimathon/utility-sass/list';
@use 'pkg:@maddimathon/utility-sass/map';
// @use 'pkg:@maddimathon/utility-sass/math';
@use 'pkg:@maddimathon/utility-sass/meta';
// @use 'pkg:@maddimathon/utility-sass/selector';
// @use 'pkg:@maddimathon/utility-sass/string';

// @use 'pkg:@maddimathon/utility-sass' as lib;

@use '../../tokens';

///
/// Returns the appropriate var (with fallback).
///
/// @since ___PKG_VERSION___
///
@function var-clr($slug, $level, $mode: tokens.$brightnessMode_default) {
    // returns
    @if not map.has-key(tokens.$colour, '#{$slug}') {
        @warn "$slug '#{$slug}' was not a key in tokens.$colour";
        @return var(--clr-#{$slug}-#{$level});
    }

    $slugMap: map.get(tokens.$colour, $slug);

    // returns
    @if meta.type-of($slugMap) != map or not map.has-key($slugMap, '#{$level}')
    {
        @warn "$level '#{$level}' was not a key in tokens.$colour.#{$slug}";
        @return var(--clr-#{$slug}-#{$level});
    }

    $dark_level: $level;

    @if $mode == dark {
        $dark_level: colour.shade-map-reverse-key(
            $level,
            $slugMap,
            $sort: if(config.$tokens_expandClrMaps, false, true)
        );
    }

    @return var(
        --clr-#{$slug}-#{$level},
        #{colour.to-hsl(
                map.get(
                    $slugMap,
                    if($mode == dark, '#{$dark_level}', '#{$level}')
                ),
                $round: false
            )}
    );
}
