///
/// @package @maddimathon/design-system-utilities@___CURRENT_VERSION___
/// @since 0.1.0-alpha
///

@use 'pkg:@maddimathon/utility-sass/list';
@use 'pkg:@maddimathon/utility-sass/map';
@use 'pkg:@maddimathon/utility-sass/meta';
@use 'pkg:@maddimathon/utility-sass/string';

@use '../../config';
@use '../../tokens';

@use 'pkg:@maddimathon/utility-astro/01-functions' as utils;

$_designSystemHasFontFamilies: map.has-key(tokens.$designSystem, font, family) and
    list.length(map.keys(map.get(tokens.$designSystem, font, family))) > 0;

@function tokens-has-font-families() {
    @return $_designSystemHasFontFamilies;
}

///
/// @since 0.1.0-alpha
///
@function font-family-exists($slug) {
    @return map.has-key(tokens.$designSystem, font, family, $slug);
}

///
/// @since 0.1.0-alpha
///
@function font-family-list($slug) {
    $fontMap: map.get(tokens.$designSystem, font, family, $slug, weights, '400', normal);

    // returns
    @if $fontMap == null {
        @warn "$slug '#{$slug}' was not a key in the font family tokens";
        @return utils.font-family-system-ui();
    }

    @return list.font-list(
        list.join((map.get($fontMap, family)), map.get($fontMap, fallbacks), $separator: comma)
    );
}

///
/// @since 0.1.0-alpha
///
@function var-font-family($slug) {
    @return if(
        config.$fn_var_replaceWithValue_fontFamily,
        font-family-list($slug),
        utils.do-var(ff-#{$slug}, font-family-list($slug))
    );
}

///
/// @since 0.1.0-alpha
/// @since 0.1.1-alpha.0 â€” Added $relative param.
///
@function var-fs($slug, $fallback: null, $relative: false) {
    // returns
    @if config.$fn_var_replaceWithValue_fontSize {
        @return if(
            $fallback == null,
            list.nth(utils.fs-value($slug, $relative: $relative), 1),
            $fallback
        );
    }

    @return utils.var-fs($slug, $fallback: $fallback, $relative: $relative);
}
