///
/// @package @maddimathon/design-system-utilities@___CURRENT_VERSION___
/// @since 0.1.0-alpha
///

@use 'pkg:@maddimathon/utility-sass/math';
@use 'pkg:@maddimathon/utility-sass/meta';

@use '../../config';
@use '../../tokens';

@use '../01-functions' as *;
@use '../02-mixins' as *;

@use 'pkg:@maddimathon/utility-astro/03-snippets' as utils;

@mixin snippet-link-colors-inherit {
    @include cx-prop(icon-color, var(--#{config.$cxPropPre}icon-color));
    color: inherit;

    &:visited {
        @include cx-prop(icon-color, var-theme(link-icon-visited));
        color: #{var-theme(link-visited)};
    }

    @include hover-focus-visible() {
        @include cx-prop(icon-color, var-theme(link-icon-hover));
        color: #{var-theme(link-hover)};
    }

    &:active {
        @include cx-prop(icon-color, var-theme(link-icon-active));
        color: #{var-theme(link-active)};
    }
}

///
/// Adds basic rules for the given heading using tokens in the system.
///
/// @since 0.1.0-alpha
///
@mixin snippet-heading($slug: '7') {
    //
    @if $slug == title {
        $slug: '1';
    }

    $fontStyle: var-style(heading-#{$slug}-font-style);

    margin-block: #{var-style(heading-#{$slug}-margin-block-start)}
        #{var-style(heading-#{$slug}-margin-block-end)};

    @if font-family-exists(heading) {
        font-family: #{var-font-family(heading)};
    }

    font-weight: #{var-style(heading-#{$slug}-font-weight)};
    font-size: #{var-fs(heading-#{$slug})};
    line-height: #{var-style(heading-#{$slug}-line-height)};
    letter-spacing: #{var-style(heading-#{$slug}-letter-spacing)};

    text-transform: #{var-style(heading-#{$slug}-text-transform)};
    text-wrap: balance;

    font-style: #{$fontStyle};

    @if $fontStyle == italic {
        em {
            font-style: normal;

            em {
                font-style: italic;
            }
        }
    }

    color: #{var-theme(heading-#{$slug})};

    %a {
        @include snippet-link-colors-inherit;
        font-weight: inherit;
    }

    %code,
    %kbd,
    %samp {
        font-weight: inherit;
        color: inherit;
    }
}

///
/// @since 0.1.0-alpha
///
@mixin snippet-selection($contrast: tokens.$contrastMode_default) {
    //
    @include cx-prop(icon-color, var-theme(selection-text, $contrast: $contrast) !important);
    color: #{var-theme(selection-text, $contrast: $contrast)} !important;

    background-color: #{var-theme(selection-bg, $contrast: $contrast)} !important;

    @if $contrast == average {
        //
        background-color: rgb(
            from #{var-theme(selection-bg, $contrast: $contrast)}
                r
                g
                b /
                var(
                    --#{config.$cxPropPre}selection-background-opacity,
                    #{var-style(selection-average-background-opacity)}
                )
        ) !important;
        //
    } @else if $contrast == low {
        //
        background-color: rgb(
            from #{var-theme(selection-bg, $contrast: $contrast)}
                r
                g
                b /
                var(
                    --#{config.$cxPropPre}selection-background-opacity,
                    #{var-style(selection-low-background-opacity)}
                )
        ) !important;
        //
    } @else if $contrast == high {
        //
        background-color: rgb(
            from #{var-theme(selection-bg, $contrast: $contrast)}
                r
                g
                b /
                var(
                    --#{config.$cxPropPre}selection-background-opacity,
                    #{var-style(selection-high-background-opacity)}
                )
        ) !important;
    }
}
