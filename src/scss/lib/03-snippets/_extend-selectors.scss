///
/// @package @maddimathon/design-system-utilities@___CURRENT_VERSION___
/// @since 0.1.0-alpha
///

@use 'pkg:@maddimathon/utility-sass/list';
@use 'pkg:@maddimathon/utility-sass/map';
@use 'pkg:@maddimathon/utility-sass/math';
@use 'pkg:@maddimathon/utility-sass/meta';
@use 'pkg:@maddimathon/utility-sass/selector';

@use 'pkg:@maddimathon/utility-astro/03-snippets' as lib;

@use '../../config';
@use '../../tokens';

@use '../01-functions' as *;
// @use '../02-mixins' as *;

@mixin extend-selectors-globals(
    $additional: (),
    $optional: null,
    $allHeadingLevels: token-all-heading-levels()
) {
    //
    $additional: list.append(
        $additional,
        (("button[type='reset']", "input[type='reset']") button-form-reset)
    );
    $additional: list.append(
        $additional,
        (("button[type='submit']", "input[type='submit']"), button-form-submit)
    );

    @if config.$print_docs {
        $additional: list.join(
            $additional,
            (
                ('.theme-mode-swatch__sample--selection', 'selection'),
                (
                    '.website-settings-menu [data-settings-reset]',
                    button-form-reset
                )
            ),
            $separator: comma
        );
    }

    @include lib.extend-selectors-globals(
        $additional: $additional,
        $optional: $optional
    );
}

@mixin extend-selectors-utils(
    $additional: (),
    $optional: null,
    $allHeadingLevels: token-all-heading-levels()
) {
    //
    $additional: list.append($additional, ('.alert-block', 'alert'));
    $additional: list.append($additional, ('p.aside', 'aside'));
    $additional: list.append($additional, ('.brand-logo', brand-logo));
    $additional: list.append($additional, ('.button-span', 'button-span'));
    $additional: list.append($additional, ('.icon', 'icon'));

    @each $iconSlug, $iconMap in tokens.$icons {
        $additional: list.append(
            $additional,
            ('.icon--#{$iconSlug}', icon--#{$iconSlug})
        );
    }

    @each $logoSlug, $logoMap in tokens.$logos {
        $additional: list.append(
            $additional,
            ('.brand-logo--#{$logoSlug}', brand-logo--#{$logoSlug})
        );
    }

    @each $variant
        in map.keys(
            map.get(
                tokens.$themes,
                tokens.$activeTheme,
                tokens.$brightnessMode_default,
                tokens.$contrastMode_default,
                button
            )
        )
    {
        @if $variant !=
            primary and
            $variant !=
            secondary and
            $variant !=
            disabled
        {
            //
            $additional: list.append(
                $additional,
                ('a.button-#{$variant}[href]', button)
            );

            $additional: list.append(
                $additional,
                (
                    (
                        selector.unify(
                            (
                                button,
                                'a',
                                "[role='button']",
                                "input[type='button']",
                                "input[type='submit']"
                            ),
                            '.button-#{$variant}'
                        )
                    ),
                    button-#{$variant}
                )
            );
        }
    }

    @include lib.extend-selectors-utils(
        $additional: $additional,
        $optional: $optional
    );
}

@mixin extend-selectors(
    $optional: null,
    $additional_globals: (),
    $additional_utils: (),
    $allHeadingLevels: token-all-heading-levels()
) {
    @if config.$print_globals {
        @include extend-selectors-globals(
            $additional: $additional_globals,
            $optional: $optional,
            $allHeadingLevels: $allHeadingLevels
        );
    }

    @if config.$print_utils {
        @include extend-selectors-utils(
            $additional: $additional_utils,
            $optional: $optional,
            $allHeadingLevels: $allHeadingLevels
        );
    }
}
