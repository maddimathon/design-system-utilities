///
/// @package @maddimathon/design-system-utilities@___CURRENT_VERSION___
/// @since 0.1.0-alpha
///
@use 'pkg:@maddimathon/utility-sass/list';
@use 'pkg:@maddimathon/utility-sass/meta';
@use 'pkg:@maddimathon/utility-sass/selector';

// @use 'pkg:@maddimathon/utility-astro/03-snippets' as lib;

// @use '../../config';
@use '../../tokens';

@use '../01-functions' as *;
// @use '../02-mixins' as *;

$_defaultHeadingSelectors: list.join(selector-all-headings(), ('%title'));

@mixin _snippet-alert-headline-heading($slug: '7') {
    //
    $slugAsNumber: if(meta.type-of($slug) == 'number', $slug, null);
    $slug: #{$slug};

    $heading10orAbove: false;

    $color: null;
    $icon_after_marginBlockStart: -0.125em;

    @if $slug and $slug != title {
        //
        $slugAsNumber: if(
            $slugAsNumber == null,
            math.num-val($slug),
            $slugAsNumber
        );

        @if $slugAsNumber >= 10 {
            $heading10orAbove: true;
        }
    }

    @if $slug == title or $slug == '1' {
        $color: var-theme(heading-1);
        $icon_after_marginBlockStart: -0.0625em;
    }

    @if $slug == '2' {
        $color: var-theme(heading-#{$slug});
        $icon_after_marginBlockStart: -0.0625em;
    }

    @if $slug == '3' {
        $color: var-theme(heading-#{$slug});
        $icon_after_marginBlockStart: -0.0625em;
    }

    @if $slug == '4' {
        $color: var-theme(heading-#{$slug});
        $icon_after_marginBlockStart: -0.09375em;
    }

    @if $slug == '5' {
        $color: var-theme(heading-#{$slug});
        $icon_after_marginBlockStart: -0.09375em;
    }

    @if $slug == '6' {
        $color: var-theme(heading-#{$slug});
        $icon_after_marginBlockStart: -0.09375em;
    }

    @if $slug == '7' or $slug == '8' or $slug == '9' or $heading10orAbove {
    }

    @if $slug == '8' {
    }

    @if $slug == '9' {
    }

    @if $slug == '10' or $heading10orAbove {
    }

    @if $heading10orAbove {
    }

    // /* placeholder - alert-headline-heading( #{$slug} ) */
    @if $color {
        color: #{$color};
    }

    > %icon {
        + * {
            margin-block-start: #{$icon_after_marginBlockStart};
        }
    }
}

///
/// Adds support for icons, assuming the html matches that in the local astro
/// Icon component.
///
/// @since 0.1.0-alpha
///
@mixin snippet-support-alert-blocks {
    %_alert-grid {
        --display: grid;
        display: grid;

        --grid-template-columns--alert-block: [icon] minmax(max-content, auto)
            [content] 1fr;
        grid-template-columns: var(--grid-template-columns--alert-block);

        grid-auto-rows: auto;
        grid-auto-flow: row;

        justify-content: start;
        justify-items: start;
        align-content: start;
        align-items: start;

        gap: 0 #{var-mrg-firm('300')};

        > * {
            grid-column: content;
        }
    }

    %alert {
        @extend %_alert-grid;
        --icon-color: #{var-token(alert-color-icon)};
        --icon-size: #{var-token(alert-icon-size)};

        justify-self: center;

        margin-block: #{var-mrg-firm('400')} #{var-mrg-half('400')};
        margin-inline: 0;
        padding: #{var-mrg-firm('300')} #{var-mrg-firm('300')}
            #{var-mrg-soft('400')};

        width: fit-content;

        line-height: #{var-line-height('300')};
        border: #{var-border-width('200')} solid
            #{var-token(alert-color-border)};

        &.alert-block--has-heading {
            margin-block-start: #{var-mrg-firm('600')};
            justify-content: stretch;
            justify-items: stretch;
            justify-self: stretch;
            width: auto;

            @each $num in token-all-heading-levels() {
                //
                $_headingSelector: if(
                    $num == 1,
                    ('%h#{$num}', '%title'),
                    '%h#{$num}'
                );

                @each $_sel
                    in (
                        ':has( #{$_headingSelector} )',
                        ':has( #{$_headingSelector}--where )'
                    )
                {
                    @at-root #{selector.unify(&, $_sel)} {
                        //
                        @if $num <= 3 {
                            margin-block-start: #{var-mrg-firm('800')};
                        }

                        @if $num > 3 {
                            border-style: #{if($num <= 6, dashed, dotted)};
                            border-width: #{var-border-width('300')};
                        }
                    }
                }
            }
        }

        > .alert-block__headline {
            @extend %_alert-grid;
            grid-template-columns: subgrid;
            grid-column: 1 / -1;

            margin: 0;
            align-items: start;

            color: #{var-token(alert-color-text)};

            @at-root #{selector.unify(&, 'header')} {
                line-height: #{var-line-height('200')};
                font-weight: 600;
                font-size: #{var-fs(heading-7)};
            }

            > :first-child {
                margin-block-start: 0;
            }

            > %icon {
                grid-column: icon;
                margin-inline-end: 0.125em;

                + * {
                    margin-block-start: -0.09375em;
                }
            }

            @at-root #{selector.unify(&, $_defaultHeadingSelectors)} {
            }
            @each $num in token-all-heading-levels() {
                //
                $_headingSelector: if(
                    $num == 1,
                    ('%h#{$num}', '%title'),
                    '%h#{$num}'
                );

                @at-root #{selector.unify(&, $_headingSelector)} {
                    @include _snippet-alert-headline-heading($num);

                    &--where {
                        @include _snippet-alert-headline-heading($num);
                    }
                }
            }
        }
    }

    @each $slug, $map in tokens.$icons {
        %alert {
            &--#{$slug} {
            }
        }
    }
}
