---
/**
 * @since ___PKG_VERSION___
 *
 * @packageDocumentation
 */

/* import - types */
import type {
    ColourLevels,
    ColourLevels_Extended,
} from '../../ts/02-tokens/@types.d.ts';
import type { Tokens } from '../../ts/02-tokens/Tokens.js';

/* import - functions */
import { toTitleCase } from '@maddimathon/utility-typescript/functions';
import { objectMap } from '../../ts/01-utilities/objectMap.js';

/* import - values */

/* import - components */
import Toggle from '@maddimathon/utility-astro/components/Toggle';
// import VariableDump from '@maddimathon/utility-astro/components/VariableDump';
import ShadeSwatchList from './ShadeSwatchList.astro';
import ShadeSwatchTable from './ShadeSwatchTable.astro';

/* import - layouts */

/* PROPS ===================================== */

export interface Props {
    tokens: Tokens.JsonReturn;
}

const { tokens }: Props = Astro.props;

/* CONSTANTS ===================================== */

// const defaultToggleToOpen = import.meta.env.DEV ? true : undefined;

const allLevels = Object.keys(tokens.colour.base) as (
    | ColourLevels
    | ColourLevels_Extended
)[];

const levelsInUse = Object.values(
    objectMap(tokens.themes, ({ value: theme }) => theme.levelsInUse)
).flat();

const excludeLevels = import.meta.env.DEV
    ? []
    : allLevels.filter((level) => !levelsInUse.includes(level));
---

<ShadeSwatchTable
    heading={2}
    id='all-colours'
    colour={tokens.colour}
    excludeLevels={excludeLevels}
    tokens={tokens}
/>

{
    (Object.keys(tokens.colour) as (keyof typeof tokens.colour)[]).map(
        (name) => (
            <Toggle
                class='shades-list-toggle'
                heading={2}
                id={`shades-${name}`}
            >
                <Fragment
                    set:text={`All ${toTitleCase(name)} Shades`}
                    slot='button'
                />
                <ShadeSwatchList
                    bases={tokens.colour.base}
                    colour={tokens.colour[name]}
                    id={`shades-${name}__list`}
                    name={name}
                    shadeHeading={3}
                    tokens={tokens}
                />
            </Toggle>
        )
    )
}

<style lang='scss'>
    @forward '../scss/page-content-colour';
</style>
